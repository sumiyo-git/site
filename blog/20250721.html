<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" type="text/css" href="../css/default.css">
	<link rel="preload" as="font" crossorigin="anonymous" href="../src/font/Poppins Regular.woff2" />
	<style>
	.ibox0 {
		aspect-ratio: 17 / 7;
		width: 80%;
		border: rgba(var(--t-t1), 0.1) 1px solid;
	}
	.ibox1 {
		aspect-ratio: 32 / 15;
		border: rgba(var(--t-t1), 0.1) 1px solid;
	}
	@media (orientation: portrait) {
		.ibox0 {
			width: 100%;
		}
	}

	</style>
</head>
<body>
<div class="main" >

	<para>
		<h1>Chrome 假死现象</h1>
		<note>发现一个使用谷歌浏览器的小技巧 ...</note>
	</para>

	<para>
		经常逛 safebooru，检索了几十页图片后咱的 Chrome 都会变得越来越卡。多刷新几次后，连 index 都加载不出来了，整个页面直接白板。
		<br />
		<mat></mat>
		<mat></mat>
		<a class="ibox0" target="_blank" href="../src/img/20250721.1.webp" >
			<img src="../src/img/20250721.1.webp" onload="this.setAttribute('class', 'fade')" />
		</a>
		<br class="f-1" />
		<br class="f-1" />
		这就是多数优化文章中都没有提到的 Chrome "假死" 现象。有兴趣的读者可以看看这位博主的文章:
		<br />
		<note>https://www.cnblogs.com/xzysaber/p/5264364.html</note>
		<br />
		<br class="f-1" />
		"假死" 问题的本质是 Chrome 分配给该域名的 socket 连接池被旧的活动连接占满，该 Chrome 窗口下对同一域名的新请求都会被堵塞（状态: 待处理）。注意，这个问题不能简单地用 "网卡" 来描述哦，它本质上是 Chrome 窗口的优先级错乱。常规的强制刷新、清空缓存等操作都不能有效解决问题。
		<br />
		<br class="f-1" />
		后来咱就干脆换上 Chrome 的无痕窗口（无痕窗口拥有独立于正常窗口的连接池）。重开 "假死" 的无痕窗口便可以轻松解决问题（socket 资源重置）。
	</para>

	<para>
		那有没有不需要重开浏览器窗口的方法呢 ?
		<br />
		ヘヘ，就是这个:
		<br />
		<attention>chrome://net-internals/#sockets</attention>
		<br />
		<mat></mat>
		<mat></mat>
		点击长成这个样子 <input type="button" value="Flush socket pools" onclick="alert('啊啊，不要乱点咱 !\n人家只是一个例子而已啦 ...')" /> 的按钮，就可以在不关闭浏览器窗口的情况下强制释放冗余连接，让窗口变得像刚打开的一样快。
		<br />
		<br class="f-1" />
		<note>注意: 这样做会中断当前窗口的所有请求。</note>
	</para>

	<para>
		实际上，在 CRX 搜搜 上有个叫 <ins>Flush DNS & close sockets</ins> 的浏览器扩展。
		<br />
		<note>https://www.crxsoso.com/webstore/detail/mlmlfmdmhdplgecgmiihhfjodokajeel</note>
		<br />
		<br class="f-1" />
		这是咱的魔改版本:
		<br />
		<mat></mat>
		<mat></mat>
		<a class="ibox1" target="_blank" href="../src/img/20250721.2.webp" >
			<img src="../src/img/20250721.2.webp" onload="this.setAttribute('class', 'fade')" />
		</a>
		<br class="f-1" />
		<br class="f-1" />
		他在窗口右上角的扩展栏内添加了一个刷新 socket 连接池的按钮。<ins>使用该插件前需要给浏览器加上 --enable-net-benchmarking 的启动参数哦。</ins>
	</para>

</div>
<script>
	window.parent.postMessage(`env.f.root.page.ok("${document.querySelectorAll('h1')[0].innerText}")`, document.domain ? '/' : '*')
	window.addEventListener('message', function(event) {
		if (event.origin == 'null' || event.origin.includes(document.domain)) {eval(event.data)}
	})
</script>
</body>
</html>